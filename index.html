<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="build/botui.min.css">
  <link rel="stylesheet" href="build/botui-theme-default.css">
  <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>

  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCj5PWFNw9dM1hT_tMXWJ6g99K7B66RA-o",
      authDomain: "final-year-proje-1539060754667.firebaseapp.com",
      databaseURL: "https://final-year-proje-1539060754667.firebaseio.com",
      projectId: "final-year-proje-1539060754667",
      storageBucket: "final-year-proje-1539060754667.appspot.com",
      messagingSenderId: "1065905789220"
    };
    firebase.initializeApp(config);
  </script>
</head>

<body>
  <div class="botui-app-container" id="hello-world">
    <bot-ui></bot-ui>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
  <script src="build/botui.js"></script>
  <script>
    var provider = new firebase.auth.GithubAuthProvider();
    let theBot = document.getElementById("hello-world")
    function login() {
      firebase.auth().signInWithPopup(provider).then(function (result) {
        var token = result.credential.accessToken;
        var user = result.user;
        console.log(user)
      }).catch(function (error) {
        var errorMessage = error.message;
        console.log(errorMessage)
      });
    }
    
  </script>
  <script>
    var botui = new BotUI('hello-world');
    var data = {}
    let sendMessage = (c, d, l) => {
      return botui.message.add({
        delay: d,
        content: c,
        loading: l
      })
    }
    let buttons = (array) => {
      return botui.action.button({
        action: array
      })
    }
    let dropDown = (placeHolder, val, multipleselect, label, options, btn) => {
      let courses = [{
        value: "coursera_ng",
        text: "Coursera ML Andrew Ng"
      }, {
        value: "udacity",
        text: "Udacity Deep Learning"
      }, {
        value: "tf",
        text: "Tensorflow official tutorial"
      }, {
        value: "goog",
        text: "Goolge ML Crash Course"
      }, {
        value: "fastai",
        text: "Fast.ai"
      }, {
        value: "kaggle",
        text: "ML course on Kaggle"
      }, {
        value: "mastery",
        text: "Machine Learning Mastery blog"
      }, {
        value: "coursera_dc",
        text: "ML Specialization, University of Washington, Coursera"
      }, {
        value: "others",
        text: "None"
      }]

      return botui.action.select({
        action: {
          placeholder: placeHolder,
          value: val, // Selected value or selected object. Example: {value: "TR", text : "Türkçe" }
          multipleselect: multipleselect, // Default: true, false for standart dropdown
          label: label, // dropdown label variable
          options: courses,
          button: btn
        }
      })
    }

    let getInput = (text) => {
      return botui.action.text({
        action: {
          placeholder: text
        }
      })
    }

    sendMessage("hi. what's your name?", 2000, true).then(() => {
      getInput("write your name here").then((res) => {
        data["name"] = res.value
        sendMessage(`Hi ${res.value} :)`, 1000, true)
      }).then(() => sendMessage("I'm a virtual mentor in the making. Thanks for being my reverse mentor :p", 2000,
        false)).then(() =>{
          sendMessage("I'm currently interested to chat with people who've taken an online Machine Learning course before.", 1000, false).then(() => {
          sendMessage("Before we go further, mind logging in with your Github account?", 1000, false).then(() => {
            buttons([{text: 'Sure, login via Github', value: 'github'}, {text: 'uh I dont have a Github account', value:'no'}]).then(function (res) {
              if(res.value === 'github')
                login()
              else
                sendMessage("Alright, no probs.", 1000, false)
            }).then(() => sendMessage(
        "Tell me..what's an ML course that you've taken that you really liked? see if it's in this list:", 1000,
        false)).then(() => dropDown("Pick a course or select 'None'", "NG", true, 'text', 'courses', {
        icon: 'check',
        label: 'OK'
      })).then(function (res) {
        if (res.value !== "others") {
          data["name"]["ml_courses_liked"] = res.value
          sendMessage("Awesome!", 1000, true)
          console.log(data)
        } else {
          sendMessage("No problem! do you have a favorite course that you wanna add to the list?", 1000, false)
            .then(() => {
              buttons([{
                text: 'Yes',
                value: 'y'
              }, {
                text: 'Nope',
                value: 'n'
              }]).then(function (res) {
                if (res.value === 'y') {
                  sendMessage(
                    "Tell me the URL of the course and I'll review and add it to the list :)", 1000,
                    true).then(() => {
                    getInput("Course URL").then(() => {
                      data["name"]["adding_new_course"] = true
                      data
                    })
                  })
                } else 
                  sendMessage("what are you good for", 3000, true).then(() => {
                    sendMessage("you had one job..![am i a joke to you](src/img/joke.jpeg)", 1000, true)
                  })
              })
            })

        }
      }).then(() => {
        sendMessage("Do you prefer learning from text or videos?",1000,false).then(() => buttons([{text: "Text", value: "text"}, {text: "Videos", value: "video"}])).then(() => sendMessage("interesting. cool cool", 2000, true))
      })
        })
          })
        })
    })
  </script>

</body>

</html>